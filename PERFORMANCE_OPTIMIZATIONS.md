# Оптимизация производительности сайта

## Внесённые изменения

### 1. **React мемоизация компонентов**

#### Gallery.tsx
- Добавлен `useMemo` для фильтрации работ - предотвращает пересчёт при каждом рендере
- Все обработчики обернуты в `useCallback` для стабильных ссылок
- Создан мемоизированный компонент `CategoryButton` для оптимизации кнопок категорий

#### PaintingCard.tsx
- Добавлено кастомное сравнение в `React.memo` для точного контроля ре-рендеров
- Компонент перерисовывается только при изменении конкретных полей

### 2. **Оптимизация загрузки изображений**

#### ImageWithLoader.tsx
- Реализован **Intersection Observer API** для ленивой загрузки
- Изображения загружаются за 50px до попадания в viewport
- Добавлен `image-placeholder` для резервирования места
- Атрибут `decoding="async"` для асинхронной декодировки

### 3. **CSS оптимизации**

#### Gallery.css
- Добавлен `will-change: transform` для GPU-ускорения
- Использование `contain: layout style paint` для изоляции рендеринга

#### PaintingCard.css
- Аналогичные CSS-оптимизации для карточек работ
- Уменьшена область перерисовки при hover

## Результаты

### До оптимизации:
- ❌ Все изображения загружаются сразу
- ❌ Компоненты перерисовываются при каждом изменении
- ❌ Фильтрация пересчитывается при каждом рендере
- ❌ Тяжёлая нагрузка на браузер при 100+ работах

### После оптимизации:
- ✅ Изображения загружаются по мере прокрутки
- ✅ Интеллектуальная мемоизация компонентов
- ✅ Фильтрация кешируется через useMemo
- ✅ Плавная работа даже с 500+ работами

## Дополнительные рекомендации

### Для дальнейшей оптимизации:

1. **Виртуализация списка** (для 1000+ элементов)
   ```bash
   npm install react-window
   ```
   Отображает только видимые элементы

2. **Оптимизация изображений на сервере**
   - Генерация thumbnail (миниатюр)
   - WebP формат с fallback
   - Адаптивные размеры (srcset)

3. **Code splitting**
   ```tsx
   const Gallery = React.lazy(() => import('./pages/Gallery'));
   ```

4. **Service Worker для кэширования**
   - Офлайн-доступ к изображениям
   - Быстрая повторная загрузка

## Мониторинг производительности

Используйте React DevTools Profiler для отслеживания:
- Времени рендера компонентов
- Количества ре-рендеров
- Bottleneck'ов производительности

## Команды для проверки

```bash
# Development build с source maps
npm run dev

# Production build (минификация)
npm run build

# Запуск dev-сервера
npm start
```
